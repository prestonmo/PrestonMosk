"0","#| echo: false"
"0",""
"0",""
"0","Midterm <- data.frame("
"0","  Year = c(""2020"", ""2024""),"
"0","  Democrat   = c(51.3, 48.3),"
"0","  Republican = c(46.9, 49.8),"
"0","  Other      = c(1.8, 1.9)"
"0",")"
"0",""
"0","Midterm_long <- pivot_longer(Midterm, cols = c(Democrat, Republican, Other),"
"0","                              names_to = ""Candidate"", values_to = ""Percentage"")"
"0",""
"0","Midterm_long$Label <- paste0(Midterm_long$Percentage, ""%"")"
"0",""
"0","# labels placement"
"0","Midterm_long <- Midterm_long %>%"
"0","  mutate("
"0","    v_nudge = case_when("
"0","      Candidate == ""Other""      ~ 2.1,"
"0","      Candidate == ""Democrat""   ~ -1.6,"
"0","      Candidate == ""Republican"" ~ -1.0,"
"0","      TRUE                      ~ 0"
"0","    ),"
"0","    h_nudge = case_when("
"0","      Candidate == ""Other""      ~ 0,"
"0","      Candidate == ""Democrat""   ~ 0.15,"
"0","      Candidate == ""Republican"" ~ 0.15,"
"0","      TRUE                      ~ 0"
"0","    )"
"0","  )"
"0",""
"0","# labels placement"
"0","change_labels <- Midterm %>%"
"0","  summarise("
"0","    Democrat    = round(Democrat[Year == ""2024""] - Democrat[Year == ""2020""], 1),"
"0","    Republican  = round(Republican[Year == ""2024""] - Republican[Year == ""2020""], 1),"
"0","    Other       = round(Other[Year == ""2024""] - Other[Year == ""2020""], 1)"
"0","  ) %>%"
"0","  pivot_longer(cols = everything(), names_to = ""Candidate"", values_to = ""Change"") %>%"
"0","  mutate("
"0","    Label = paste0(""Δ "", Change, ""%""),"
"0","    x = 1.5,"
"0","    y = c(mean(c(51.3, 48.3)), mean(c(46.9, 49.8)), mean(c(1.8, 1.9))),"
"0","    v_nudge = case_when("
"0","      Candidate == ""Other""      ~ 1.5,"
"0","      Candidate == ""Democrat""   ~ 1,"
"0","      Candidate == ""Republican"" ~ -1.5,"
"0","      TRUE                      ~ 0"
"0","    ),"
"0","    h_nudge = case_when("
"0","      Candidate == ""Other""      ~ 0,"
"0","      Candidate == ""Democrat""   ~ 0.1,"
"0","      Candidate == ""Republican"" ~ 0.1,"
"0","      TRUE                      ~ 0"
"0","    )"
"0","  )"
"0",""
"0","# Insert Δchange "
"0","ggplot(Midterm_long, aes(x = Year, y = Percentage, group = Candidate, color = Candidate)) +"
"0","  geom_line(linewidth  = 1.2, alpha = 0.8) +"
"0","  geom_point(size = 4) +"
"0","  geom_text(aes(x = as.numeric(as.factor(Year)) + h_nudge,"
"0","                y = Percentage + v_nudge,"
"0","                label = Label),"
"0","            size = 3.5) +"
"0","  geom_text(data = change_labels,"
"0","            aes(x = x + h_nudge, y = y + v_nudge, label = Label, color = Candidate),"
"0","            fontface = ""bold"", size = 4, inherit.aes = FALSE) +"
"0","  scale_x_discrete(limits = c(""2020"", ""2024"")) +"
"0","  scale_color_manual(values = c(""Democrat"" = ""#1f77b4"", ""Republican"" = ""red"", ""Other"" = ""gray40"")) +"
"0","  labs(title = ""Vote Share by Candidate (2020 vs 2024)"","
"0","       subtitle = ""Δ labels show change in vote share"","
"0","       x = ""Year"","
"0","       y = ""Percentage of Vote"","
"0","       color = ""Candidate"") +"
"0","  theme_minimal()"
