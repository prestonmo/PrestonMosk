Candidate == "Republican" ~ -1.5,
TRUE                      ~ 0
),
h_nudge = case_when(
Candidate == "Other"      ~ 0,
Candidate == "Democrat"   ~ 0.1,
Candidate == "Republican" ~ 0.1,
TRUE                      ~ 0
)
)
# Plot with moveable Δ labels
ggplot(Midterm_long, aes(x = Year, y = Percentage, group = Candidate, color = Candidate)) +
geom_line(size = 1.2, alpha = 0.8) +
geom_point(size = 4) +
geom_text(aes(x = as.numeric(as.factor(Year)) + h_nudge,
y = Percentage + v_nudge,
label = Label),
size = 3.5) +
geom_text(data = change_labels,
aes(x = x + h_nudge, y = y + v_nudge, label = Label, color = Candidate),
fontface = "bold", size = 4, inherit.aes = FALSE) +
scale_x_discrete(limits = c("2020", "2024")) +
scale_color_manual(values = c("Democrat" = "#1f77b4", "Republican" = "red", "Other" = "gray40")) +
labs(title = "Vote Share by Candidate (2020 vs 2024)",
subtitle = "Δ labels show change in vote share",
x = "Year",
y = "Percentage of Vote",
color = "Candidate") +
theme_minimal()
#| echo: false
a
#| echo: false
Midterm <- read_excel("Midterm.xlsx")
Midterm <- data.frame(
Year = c("2020", "2024"),
BH = c(51.3, 48.3),
T  = c(46.9, 49.8),
O  = c(1.8, 1.9)
)
Midterm <- data.frame(
Year = c("2020", "2024"),
BH = c(51.3, 48.3),
T  = c(46.9, 49.8),
O  = c(1.8, 1.9)
)
Midterm_long <- pivot_longer(Midterm, cols = c(BH, T, O), names_to = "Variable", values_to = "Value")
# Rename variables
Midterm_long$Variable <- recode(Midterm_long$Variable,
BH = "Democrat",
O  = "Other",
T  = "Republican")
# Set factor levels to control order
Midterm_long$Variable <- factor(Midterm_long$Variable, levels = c("Democrat", "Other", "Republican"))
# Split by year
Midterm_2020 <- subset(Midterm_long, Year == "2020")
Midterm_2024 <- subset(Midterm_long, Year == "2024")
# Add percentage labels
Midterm_2020$Label <- paste0(Midterm_2020$Value, "%")
Midterm_2024$Label <- paste0(Midterm_2024$Value, "%")
# Plot with offset labels to prevent overlap
library(ggplot2)
ggplot() +
geom_bar(data = Midterm_2020, aes(x = Variable, y = Value, fill = "2020"),
stat = "identity", position = "identity", alpha = 0.8) +
geom_text(data = Midterm_2020, aes(x = Variable, y = Value, label = Label),
position = position_nudge(x = -0.15, y = 0.5),
color = "black", size = 3.5) +
geom_bar(data = Midterm_2024, aes(x = Variable, y = Value, fill = "2024"),
stat = "identity", position = "identity", alpha = 0.4) +
geom_text(data = Midterm_2024, aes(x = Variable, y = Value, label = Label),
position = position_nudge(x = 0.15, y = -0.5),
color = "black", size = 3.5) +
scale_fill_manual(values = c("2020" = "#1f77c1", "2024" = "#FF0000")) +
labs(title = "Diffence In Election Outcomes From 2020 To 2024",
x = "Candidates",
y = "Percentage of Vote",
fill = "Year") +
theme_minimal()
#| echo: false
Midterm <- read_excel("Midterm.xlsx")
Midterm <- data.frame(
Year = c("2020", "2024"),
BH = c(51.3, 48.3),
T  = c(46.9, 49.8),
O  = c(1.8, 1.9)
)
Midterm <- data.frame(
Year = c("2020", "2024"),
BH = c(51.3, 48.3),
T  = c(46.9, 49.8),
O  = c(1.8, 1.9)
)
Midterm_long <- pivot_longer(Midterm, cols = c(BH, T, O), names_to = "Variable", values_to = "Value")
# Rename variables
Midterm_long$Variable <- recode(Midterm_long$Variable,
BH = "Democrat",
O  = "Other",
T  = "Republican")
# Set factor levels to control order
Midterm_long$Variable <- factor(Midterm_long$Variable, levels = c("Democrat", "Other", "Republican"))
# Split by year
Midterm_2020 <- subset(Midterm_long, Year == "2020")
Midterm_2024 <- subset(Midterm_long, Year == "2024")
# Add percentage labels
Midterm_2020$Label <- paste0(Midterm_2020$Value, "%")
Midterm_2024$Label <- paste0(Midterm_2024$Value, "%")
# Plot with offset labels to prevent overlap
library(ggplot2)
ggplot() +
geom_bar(data = Midterm_2020, aes(x = Variable, y = Value, fill = "2020"),
stat = "identity", position = "identity", alpha = 0.8) +
geom_text(data = Midterm_2020, aes(x = Variable, y = Value, label = Label),
position = position_nudge(x = -0.15, y = 0.5),
color = "black", size = 3.5) +
geom_bar(data = Midterm_2024, aes(x = Variable, y = Value, fill = "2024"),
stat = "identity", position = "identity", alpha = 0.4) +
geom_text(data = Midterm_2024, aes(x = Variable, y = Value, label = Label),
position = position_nudge(x = 0.15, y = -0.5),
color = "black", size = 3.5) +
scale_fill_manual(values = c("2020" = "#1f77c1", "2024" = "#FF0000")) +
labs(title = "Diffence In Election Outcomes From 2020 To 2024",
x = "Candidates",
y = "Percentage of Vote",
fill = "Year") +
theme_minimal()
library(tidyverse)
# Original data
Midterm <- data.frame(
Year = c("2020", "2024"),
Democrat   = c(51.3, 48.3),
Republican = c(46.9, 49.8),
Other      = c(1.8, 1.9)
)
# Reshape to long format
Midterm_long <- pivot_longer(Midterm, cols = c(Democrat, Republican, Other),
names_to = "Candidate", values_to = "Percentage")
# Add label text
Midterm_long$Label <- paste0(Midterm_long$Percentage, "%")
# Apply nudging to vote percentage labels
Midterm_long <- Midterm_long %>%
mutate(
v_nudge = case_when(
Candidate == "Other"      ~ 2.1,
Candidate == "Democrat"   ~ -1.6,
Candidate == "Republican" ~ -1.0,
TRUE                      ~ 0
),
h_nudge = case_when(
Candidate == "Other"      ~ 0,
Candidate == "Democrat"   ~ 0.15,
Candidate == "Republican" ~ 0.15,
TRUE                      ~ 0
)
)
# Compute change labels and midpoint positions with nudging
change_labels <- Midterm %>%
summarise(
Democrat    = round(Democrat[Year == "2024"] - Democrat[Year == "2020"], 1),
Republican  = round(Republican[Year == "2024"] - Republican[Year == "2020"], 1),
Other       = round(Other[Year == "2024"] - Other[Year == "2020"], 1)
) %>%
pivot_longer(cols = everything(), names_to = "Candidate", values_to = "Change") %>%
mutate(
Label = paste0("Δ ", Change, "%"),
x = 1.5,
y = c(mean(c(51.3, 48.3)), mean(c(46.9, 49.8)), mean(c(1.8, 1.9))),
v_nudge = case_when(
Candidate == "Other"      ~ 1.5,
Candidate == "Democrat"   ~ 1,
Candidate == "Republican" ~ -1.5,
TRUE                      ~ 0
),
h_nudge = case_when(
Candidate == "Other"      ~ 0,
Candidate == "Democrat"   ~ 0.1,
Candidate == "Republican" ~ 0.1,
TRUE                      ~ 0
)
)
# Plot with moveable Δ labels
ggplot(Midterm_long, aes(x = Year, y = Percentage, group = Candidate, color = Candidate)) +
geom_line(size = 1.2, alpha = 0.8) +
geom_point(size = 4) +
geom_text(aes(x = as.numeric(as.factor(Year)) + h_nudge,
y = Percentage + v_nudge,
label = Label),
size = 3.5) +
geom_text(data = change_labels,
aes(x = x + h_nudge, y = y + v_nudge, label = Label, color = Candidate),
fontface = "bold", size = 4, inherit.aes = FALSE) +
scale_x_discrete(limits = c("2020", "2024")) +
scale_color_manual(values = c("Democrat" = "#1f77b4", "Republican" = "red", "Other" = "gray40")) +
labs(title = "Vote Share by Candidate (2020 vs 2024)",
subtitle = "Δ labels show change in vote share",
x = "Year",
y = "Percentage of Vote",
color = "Candidate") +
theme_minimal()
library(tidyverse)
# Original data
Midterm <- data.frame(
Year = c("2020", "2024"),
Democrat   = c(51.3, 48.3),
Republican = c(46.9, 49.8),
Other      = c(1.8, 1.9)
)
# Reshape to long format
Midterm_long <- pivot_longer(Midterm, cols = c(Democrat, Republican, Other),
names_to = "Candidate", values_to = "Percentage")
# Add label text
Midterm_long$Label <- paste0(Midterm_long$Percentage, "%")
# Apply nudging to vote percentage labels
Midterm_long <- Midterm_long %>%
mutate(
v_nudge = case_when(
Candidate == "Other"      ~ 2.1,
Candidate == "Democrat"   ~ -1.6,
Candidate == "Republican" ~ -1.0,
TRUE                      ~ 0
),
h_nudge = case_when(
Candidate == "Other"      ~ 0,
Candidate == "Democrat"   ~ 0.15,
Candidate == "Republican" ~ 0.15,
TRUE                      ~ 0
)
)
# Compute change labels and midpoint positions with nudging
change_labels <- Midterm %>%
summarise(
Democrat    = round(Democrat[Year == "2024"] - Democrat[Year == "2020"], 1),
Republican  = round(Republican[Year == "2024"] - Republican[Year == "2020"], 1),
Other       = round(Other[Year == "2024"] - Other[Year == "2020"], 1)
) %>%
pivot_longer(cols = everything(), names_to = "Candidate", values_to = "Change") %>%
mutate(
Label = paste0("Δ ", Change, "%"),
x = 1.5,
y = c(mean(c(51.3, 48.3)), mean(c(46.9, 49.8)), mean(c(1.8, 1.9))),
v_nudge = case_when(
Candidate == "Other"      ~ 1.5,
Candidate == "Democrat"   ~ 1,
Candidate == "Republican" ~ -1.5,
TRUE                      ~ 0
),
h_nudge = case_when(
Candidate == "Other"      ~ 0,
Candidate == "Democrat"   ~ 0.1,
Candidate == "Republican" ~ 0.1,
TRUE                      ~ 0
)
)
# Plot with moveable Δ labels
ggplot(Midterm_long, aes(x = Year, y = Percentage, group = Candidate, color = Candidate)) +
geom_line(size = 1.2, alpha = 0.8) +
geom_point(size = 4) +
geom_text(aes(x = as.numeric(as.factor(Year)) + h_nudge,
y = Percentage + v_nudge,
label = Label),
size = 3.5) +
geom_text(data = change_labels,
aes(x = x + h_nudge, y = y + v_nudge, label = Label, color = Candidate),
fontface = "bold", size = 4, inherit.aes = FALSE) +
scale_x_discrete(limits = c("2020", "2024")) +
scale_color_manual(values = c("Democrat" = "#1f77b4", "Republican" = "red", "Other" = "gray40")) +
labs(title = "Vote Share by Candidate (2020 vs 2024)",
subtitle = "Δ labels show change in vote share",
x = "Year",
y = "Percentage of Vote",
color = "Candidate") +
theme_minimal()
library(tidyverse)
# Original data
Midterm <- data.frame(
Year = c("2020", "2024"),
Democrat   = c(51.3, 48.3),
Republican = c(46.9, 49.8),
Other      = c(1.8, 1.9)
)
# Reshape to long format
Midterm_long <- pivot_longer(Midterm, cols = c(Democrat, Republican, Other),
names_to = "Candidate", values_to = "Percentage")
# Add label text
Midterm_long$Label <- paste0(Midterm_long$Percentage, "%")
# Apply nudging to vote percentage labels
Midterm_long <- Midterm_long %>%
mutate(
v_nudge = case_when(
Candidate == "Other"      ~ 2.1,
Candidate == "Democrat"   ~ -1.6,
Candidate == "Republican" ~ -1.0,
TRUE                      ~ 0
),
h_nudge = case_when(
Candidate == "Other"      ~ 0,
Candidate == "Democrat"   ~ 0.15,
Candidate == "Republican" ~ 0.15,
TRUE                      ~ 0
)
)
# Compute change labels and midpoint positions with nudging
change_labels <- Midterm %>%
summarise(
Democrat    = round(Democrat[Year == "2024"] - Democrat[Year == "2020"], 1),
Republican  = round(Republican[Year == "2024"] - Republican[Year == "2020"], 1),
Other       = round(Other[Year == "2024"] - Other[Year == "2020"], 1)
) %>%
pivot_longer(cols = everything(), names_to = "Candidate", values_to = "Change") %>%
mutate(
Label = paste0("Δ ", Change, "%"),
x = 1.5,
y = c(mean(c(51.3, 48.3)), mean(c(46.9, 49.8)), mean(c(1.8, 1.9))),
v_nudge = case_when(
Candidate == "Other"      ~ 1.5,
Candidate == "Democrat"   ~ 1,
Candidate == "Republican" ~ -1.5,
TRUE                      ~ 0
),
h_nudge = case_when(
Candidate == "Other"      ~ 0,
Candidate == "Democrat"   ~ 0.1,
Candidate == "Republican" ~ 0.1,
TRUE                      ~ 0
)
)
# Plot with moveable Δ labels
ggplot(Midterm_long, aes(x = Year, y = Percentage, group = Candidate, color = Candidate)) +
geom_line(size = 1.2, alpha = 0.8) +
geom_point(size = 4) +
geom_text(aes(x = as.numeric(as.factor(Year)) + h_nudge,
y = Percentage + v_nudge,
label = Label),
size = 3.5) +
geom_text(data = change_labels,
aes(x = x + h_nudge, y = y + v_nudge, label = Label, color = Candidate),
fontface = "bold", size = 4, inherit.aes = FALSE) +
scale_x_discrete(limits = c("2020", "2024")) +
scale_color_manual(values = c("Democrat" = "#1f77b4", "Republican" = "red", "Other" = "gray40")) +
labs(title = "Vote Share by Candidate (2020 vs 2024)",
subtitle = "Δ labels show change in vote share",
x = "Year",
y = "Percentage of Vote",
color = "Candidate") +
theme_minimal()
#| include: false
library(tidyverse)
# Original data
Midterm <- data.frame(
Year = c("2020", "2024"),
Democrat   = c(51.3, 48.3),
Republican = c(46.9, 49.8),
Other      = c(1.8, 1.9)
)
# Reshape to long format
Midterm_long <- pivot_longer(Midterm, cols = c(Democrat, Republican, Other),
names_to = "Candidate", values_to = "Percentage")
# Add label text
Midterm_long$Label <- paste0(Midterm_long$Percentage, "%")
# Apply nudging to vote percentage labels
Midterm_long <- Midterm_long %>%
mutate(
v_nudge = case_when(
Candidate == "Other"      ~ 2.1,
Candidate == "Democrat"   ~ -1.6,
Candidate == "Republican" ~ -1.0,
TRUE                      ~ 0
),
h_nudge = case_when(
Candidate == "Other"      ~ 0,
Candidate == "Democrat"   ~ 0.15,
Candidate == "Republican" ~ 0.15,
TRUE                      ~ 0
)
)
# Compute change labels and midpoint positions with nudging
change_labels <- Midterm %>%
summarise(
Democrat    = round(Democrat[Year == "2024"] - Democrat[Year == "2020"], 1),
Republican  = round(Republican[Year == "2024"] - Republican[Year == "2020"], 1),
Other       = round(Other[Year == "2024"] - Other[Year == "2020"], 1)
) %>%
pivot_longer(cols = everything(), names_to = "Candidate", values_to = "Change") %>%
mutate(
Label = paste0("Δ ", Change, "%"),
x = 1.5,
y = c(mean(c(51.3, 48.3)), mean(c(46.9, 49.8)), mean(c(1.8, 1.9))),
v_nudge = case_when(
Candidate == "Other"      ~ 1.5,
Candidate == "Democrat"   ~ 1,
Candidate == "Republican" ~ -1.5,
TRUE                      ~ 0
),
h_nudge = case_when(
Candidate == "Other"      ~ 0,
Candidate == "Democrat"   ~ 0.1,
Candidate == "Republican" ~ 0.1,
TRUE                      ~ 0
)
)
# Plot with moveable Δ labels
ggplot(Midterm_long, aes(x = Year, y = Percentage, group = Candidate, color = Candidate)) +
geom_line(size = 1.2, alpha = 0.8) +
geom_point(size = 4) +
geom_text(aes(x = as.numeric(as.factor(Year)) + h_nudge,
y = Percentage + v_nudge,
label = Label),
size = 3.5) +
geom_text(data = change_labels,
aes(x = x + h_nudge, y = y + v_nudge, label = Label, color = Candidate),
fontface = "bold", size = 4, inherit.aes = FALSE) +
scale_x_discrete(limits = c("2020", "2024")) +
scale_color_manual(values = c("Democrat" = "#1f77b4", "Republican" = "red", "Other" = "gray40")) +
labs(title = "Vote Share by Candidate (2020 vs 2024)",
subtitle = "Δ labels show change in vote share",
x = "Year",
y = "Percentage of Vote",
color = "Candidate") +
theme_minimal()
#| echo: false
ggplot(Midterm_long, aes(x = Year, y = Percentage, group = Candidate, color = Candidate)) +
geom_line(linewidth = 1.2, alpha = 0.8) +  # ✅ updated from size to linewidth
geom_point(size = 4) +
geom_text(aes(x = as.numeric(as.factor(Year)) + h_nudge,
y = Percentage + v_nudge,
label = Label),
size = 3.5) +
geom_text(data = change_labels,
aes(x = x + h_nudge, y = y + v_nudge, label = Label, color = Candidate),
fontface = "bold", size = 4, inherit.aes = FALSE) +
scale_x_discrete(limits = c("2020", "2024")) +
scale_color_manual(values = c("Democrat" = "#1f77b4", "Republican" = "red", "Other" = "gray40")) +
labs(title = "Vote Share by Candidate (2020 vs 2024)",
subtitle = "Δ labels show change in vote share",
x = "Year",
y = "Percentage of Vote",
color = "Candidate") +
theme_minimal()
#| include: false
library(tidyverse)
#| echo: false
# Original data
Midterm <- data.frame(
Year = c("2020", "2024"),
Democrat   = c(51.3, 48.3),
Republican = c(46.9, 49.8),
Other      = c(1.8, 1.9)
)
# Reshape to long format
Midterm_long <- pivot_longer(Midterm, cols = c(Democrat, Republican, Other),
names_to = "Candidate", values_to = "Percentage")
# Add label text
Midterm_long$Label <- paste0(Midterm_long$Percentage, "%")
# Apply nudging to vote percentage labels
Midterm_long <- Midterm_long %>%
mutate(
v_nudge = case_when(
Candidate == "Other"      ~ 2.1,
Candidate == "Democrat"   ~ -1.6,
Candidate == "Republican" ~ -1.0,
TRUE                      ~ 0
),
h_nudge = case_when(
Candidate == "Other"      ~ 0,
Candidate == "Democrat"   ~ 0.15,
Candidate == "Republican" ~ 0.15,
TRUE                      ~ 0
)
)
# Compute change labels and midpoint positions with nudging
change_labels <- Midterm %>%
summarise(
Democrat    = round(Democrat[Year == "2024"] - Democrat[Year == "2020"], 1),
Republican  = round(Republican[Year == "2024"] - Republican[Year == "2020"], 1),
Other       = round(Other[Year == "2024"] - Other[Year == "2020"], 1)
) %>%
pivot_longer(cols = everything(), names_to = "Candidate", values_to = "Change") %>%
mutate(
Label = paste0("Δ ", Change, "%"),
x = 1.5,
y = c(mean(c(51.3, 48.3)), mean(c(46.9, 49.8)), mean(c(1.8, 1.9))),
v_nudge = case_when(
Candidate == "Other"      ~ 1.5,
Candidate == "Democrat"   ~ 1,
Candidate == "Republican" ~ -1.5,
TRUE                      ~ 0
),
h_nudge = case_when(
Candidate == "Other"      ~ 0,
Candidate == "Democrat"   ~ 0.1,
Candidate == "Republican" ~ 0.1,
TRUE                      ~ 0
)
)
# Plot with moveable Δ labels
ggplot(Midterm_long, aes(x = Year, y = Percentage, group = Candidate, color = Candidate)) +
geom_line(linewidth  = 1.2, alpha = 0.8) +
geom_point(size = 4) +
geom_text(aes(x = as.numeric(as.factor(Year)) + h_nudge,
y = Percentage + v_nudge,
label = Label),
size = 3.5) +
geom_text(data = change_labels,
aes(x = x + h_nudge, y = y + v_nudge, label = Label, color = Candidate),
fontface = "bold", size = 4, inherit.aes = FALSE) +
scale_x_discrete(limits = c("2020", "2024")) +
scale_color_manual(values = c("Democrat" = "#1f77b4", "Republican" = "red", "Other" = "gray40")) +
labs(title = "Vote Share by Candidate (2020 vs 2024)",
subtitle = "Δ labels show change in vote share",
x = "Year",
y = "Percentage of Vote",
color = "Candidate") +
theme_minimal()
